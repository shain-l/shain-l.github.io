<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>RIP的应用</title>
    <url>/2020/08/27/RIP%E7%9A%84%E5%BA%94%E7%94%A8/</url>
    <content><![CDATA[<h4 id="1、-实验目的"><a href="#1、-实验目的" class="headerlink" title="1、 实验目的"></a>1、 实验目的</h4><ol>
<li>掌握RIPv2的基本配置<br></li>
<li>理解RIPv2路由条目的结构含义<br></li>
<li>理解自动汇总的含义<br></li>
<li>理解和观察周期性更新<br></li>
<li>理解debug ip rip 命令 的作用<a id="more"></a>

</li>
</ol>
<h4 id="2、-拓扑结构"><a href="#2、-拓扑结构" class="headerlink" title="2、 拓扑结构"></a>2、 拓扑结构</h4><p><img src="https://s1.ax1x.com/2020/08/28/doIIiV.png"></p>
<h4 id="3、-实验步骤"><a href="#3、-实验步骤" class="headerlink" title="3、 实验步骤"></a>3、 实验步骤</h4><p><strong>（1）完成各路由器的基本配置，实现各直连设备之间可以互 ping 对方， 要求 PC1 的 IP 地址设置为 172.16.1.1/24，网关设置为172.16.1.254， PC2 的 IP 地址设置为172.16.3.1/24，网关设置为172.16.3.254，各路由器接口间的地址自己规划。</strong></p>
<p><img src="https://s1.ax1x.com/2020/08/27/d5mDb9.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/27/d5uw79.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/27/d5NpXn.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/27/d5NkkT.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/27/d5Ne1J.png"></p>
<p><strong>（2）在三台路由器上都启用RIPv2协议，通告各自的直连网络路由，并开启自动汇总</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">默认开启自动汇总，会在边界处把一个网段汇总成主类</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2020/08/28/do543D.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/do5HHI.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/do5v8S.png"></p>
<p><strong>（3）在R1上使用show ip protocols命令，观察并理解该命令的输出信息</strong></p>
<blockquote>
<p>路由更新计时器：30s（默认）<br>路由无效时间：180s（默认）<br>抑制计时器：180s（默认）<br>路由刷新计时器：240s（默认）</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/28/dooEdI.png"></p>
<p><strong>（4）查看各路由器的路由表，观察RIP路由条目的特征</strong></p>
<blockquote>
<p>由于没有关闭自动汇总，R1上存在172.16.0.0网段的路由，则不会再学习R2上的172.16.0.0的路由</p>
<p>同理，R2上存在172.16.0.0网段的路由，则不会学习R1上的172.16.0.0的路由</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/28/doowy4.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/dooRSO.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/doo7kt.png"></p>
<p><strong>（5）分别在R2和PC2上测试R2与PC1以及PC2与PC1之间的连通性</strong></p>
<p><img src="https://s1.ax1x.com/2020/08/28/doTJnH.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/doTtHA.png"></p>
<p><strong>（6）在R2上使用debug ip rip观察路由的发送情况</strong></p>
<blockquote>
<p>RIPv2组播地址：224.0.0.9</p>
<p>由于没有关闭自动汇总，此时发送的报文都为主类路由</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/28/doT09f.png"></p>
<p><strong>（7）在三台路由器上都关闭自动汇总，观察各路由表的变化，并再次测试R2与PC1以及PC2与PC1之间的连通性</strong></p>
<p><img src="https://s1.ax1x.com/2020/08/28/doTrjg.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/doT43T.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/doTLU1.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/do7Z28.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/do7urQ.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/do7QVs.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/do70aR.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/do7yRK.png"></p>
<p><strong>（8）再次在R2上使用debug ip rip观察路由的发送情况，比较关闭自动汇总与开启自动汇总debug输出信息的不同</strong></p>
<p><img src="https://s1.ax1x.com/2020/08/28/do7von.png"></p>
<p><strong>（9）在R2上添加一个loopback1接口，地址自定</strong></p>
<p><img src="https://s1.ax1x.com/2020/08/28/doHAeJ.png"></p>
<p><strong>（10）添加必要配置，实现PC1和PC2都能够正常访问在R2上的loopback1</strong></p>
<p><img src="https://s1.ax1x.com/2020/08/28/dTPgQH.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/dTPhwt.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/dTPTfS.png"></p>
<p><strong>（11）在R1上添加一个loopback1接口，地址自定，然后在RIP中通告，观察R2和R3是否能马上学习到R1上新增的loopback1网段</strong></p>
<p><img src="https://s1.ax1x.com/2020/08/28/dTiwcQ.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/dTi7Ax.png"></p>
<blockquote>
<p>由于rip的路由表的更新时间为30s，故在R2、R3上无法马上学习到在R1上新增的loopback1网段</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/28/dTFJKJ.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/dTFtbR.png"></p>
<p><strong>（12）将R1上的loopback1接口关闭，观察R2和R3上是否还存在关于R1上的loopback1网段的路由条目</strong></p>
<blockquote>
<p>由于触发更新，R1上存在失效路由，则会马上发送更新给相邻的路由器，让他们将失效路由删除</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/28/dTA5uQ.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/dTAoHs.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/dTA7En.png"></p>
<p><strong>（13）使用wireshark抓取RIPv2报文，理解RIPv2报文各字段的含义</strong></p>
<blockquote>
<p>RIPv2运行在UDP的520端口上，属于应用层协议</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/28/dTAHNq.png"></p>
]]></content>
      <categories>
        <category>实验</category>
      </categories>
      <tags>
        <tag>路由协议</tag>
        <tag>RIP</tag>
        <tag>CCNA</tag>
      </tags>
  </entry>
  <entry>
    <title>EIGRP的简单应用</title>
    <url>/2020/08/28/EIGRP%E7%9A%84%E7%AE%80%E5%8D%95%E5%BA%94%E7%94%A8/</url>
    <content><![CDATA[<h4 id="1、实验目的"><a href="#1、实验目的" class="headerlink" title="1、实验目的"></a>1、实验目的</h4><p>1）掌握EIGRP的基本配置<br>2）理解EIGRP的邻居表、拓扑表以及路由表的含义<br>3）掌握查看EIGRP路由协议的相关信息<br>4）掌握FD、AD、S、FS以及FC的含义<br>5）理解EIGRP的hello报文作用<br>6）理解路由快速收敛的含义<br>7）理解EIGRP的不等价负载均衡</p>
<a id="more"></a>

<h4 id="2、实验拓扑"><a href="#2、实验拓扑" class="headerlink" title="2、实验拓扑"></a>2、实验拓扑</h4><p><img src="https://s1.ax1x.com/2020/08/28/dTeEvT.png"></p>
<h4 id="3、实验步骤"><a href="#3、实验步骤" class="headerlink" title="3、实验步骤"></a>3、实验步骤</h4><p><strong>（1）完成各路由器的基本配置，实现各直连设备之间可以互ping对方，要求PC1的IP地址设置为172.16.1.1/24，网关设置为172.16.1.254，PC2的IP地址设置为172.16.3.1/24，网关设置为172.16.3.254，各路由器接口间的地址自己规划</strong></p>
<blockquote>
<p>IP地址规划如拓扑图标记所示，此处不再列出</p>
</blockquote>
<p><strong>（2）全网启用EIGRP，通告各自的直连网络路由，并关闭自动汇总</strong></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">//启用EIGRP进程，AS号为90，AS号是邻居建立的前提，邻居要建立AS号必须要一样</span></span><br><span class="line">R3(config)#router eigrp 90 </span><br><span class="line"><span class="comment">//关闭自动汇总</span></span><br><span class="line">R3(config-router)#no auto-summary  </span><br><span class="line"><span class="comment">//通告网段</span></span><br><span class="line">R3(config-router)#network 192.168.23.0  //通告直连网段</span><br><span class="line">R3(config-router)#network 172.16.3.0 0.0.0.255</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2020/08/28/dTmotA.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/dTmj0g.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/28/dTnCpq.png"></p>
<p><strong>（3）在R1上使用show ip protocols命令，观察并理解该命令的输出信息</strong></p>
<blockquote>
<p>Metric weight K1=1, K2=0, K3=1, K4=0, K5=0   – EIGRP的开销计算与这5个K值有关系</p>
<p>邻居要建立，则五个K值必须相同</p>
<p>K1：带宽；K2：负载；K3：延迟；K4：可靠性；K5：MTU</p>
<p>真正与EIGRP开销计算有关系的，只有带宽和延迟；</p>
<p>EIGRP开销=带宽+延迟</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/28/dTnHUJ.png"></p>
<p><strong>（4）查看各路由器的邻居表、拓扑表以及路由表，分别找出FD、AD以及S等重要信息</strong></p>
<blockquote>
<p>邻居表各字段含义</p>
<p>H：建立顺序</p>
<p>Address：对端的IP</p>
<p>Interface：从哪个接口学习到</p>
<p>Hold：定义了等待没有从邻居那里接收到任何包的最大时间，当接收到新的包以后，Hold复位（在10~15s之间循环）</p>
<p>Uptime：建立了多久</p>
<p>SRTT：向邻居发送包以及受到邻居回应ACK的平均回程时间</p>
<p>RTO：重传超时时间，路由器在重新传输包之前等待ACK的时间（应为SRTT的6倍，最大5000，若重传16次还未得到确认，则此邻居被宣布无效）</p>
<p>Q：队列计数，表示有多少个可靠报文还没有得到确认，在运行正常的环境下该值应为0（如果值大于0则说明发生了拥塞）</p>
<p>Seq：序列号</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/29/dTuKaQ.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTulPs.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTu1Gn.png"></p>
<blockquote>
<p>拓扑表</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/29/dTuRde.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTuWIH.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTuhid.png"></p>
<blockquote>
<p>路由表</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/29/dTuTQP.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTuOoQ.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTuvJs.png"></p>
<p><strong>（5）测试PC1与PC2之间的连通性</strong></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTKGYd.png"></p>
<p><strong>（6）在R2上添加一个loopback1接口，地址为200.200.200.200/24，然后在EIGRP中通告，观察R1和R3是否能马上学习到R2上新增的loopback1网段，并测试各主机与该loopback1之间的联通性</strong></p>
<blockquote>
<p>R1和R3能马上学习到R2上新增的loopback1网段</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/29/dTKaOf.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTK00S.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTKsYj.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTKcpn.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTKglq.png"></p>
<p><strong>（7）使用wireshark抓取EIGRP的报文，理解EIGRP报文各字段的含义</strong></p>
<blockquote>
<p>每隔5s发送一个hello包，保持时间为15s，即超过3个hello时间未收到hello则认为对端Down，断开连接</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/29/dTKTh9.png"></p>
<p><strong>（8）在R1上添加一个loopback1接口，地址为100.100.100.100/24，然后在EIGRP中通告</strong></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTKj0O.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTKv7D.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTMphd.png"></p>
<p><strong>（9）断开R1和R3与各主机之间的连接，连接R1与R3之间的以太网接口，完成必要配置，实现200.200.200.200访问100.100.100.100的不等价负载均衡</strong></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTM0jx.png"></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">//使用源200.200.200.200去访问目标100.100.100.100</span></span><br><span class="line"><span class="comment">//若没有跟上source，那么默认情况下就是使用出接口去访问目标</span></span><br><span class="line">R2#ping 100.100.100.100 source 200.200.200.200  </span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2020/08/29/dTQP54.png"></p>
<blockquote>
<p>由于此时R2的路由表中只存在一条路径到达100.100.100.100，所以此时不存在负载均衡</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/29/dTQlPH.png"></p>
<blockquote>
<p>等价负载均衡：有多条开销相等的路径，此时可以同时从这些开销相等的路径去发送数量相同的数据包。</p>
<p>不等价负载均衡：有多条路径，但是开销不一样，此时会根据一定的比例去发送数据包。</p>
<p>对于EIGRP，默认情况下只支持等价负载均衡，并且默认情况下最多可以同时存在4条的等价负载均衡。</p>
<p>R2(config)#router eigrp 90</p>
<p>R2(config-router)#maximum-paths 8     –将等价负载均衡的条数改为8条</p>
<p>EIGRP还可以支持不等价负载均衡，但是有前提：</p>
<p>①次优路径的AD值要小于最优路径的FD值–称为FC条件，只有满足了该条件，才会存在FS。</p>
<p>②当存在FS之后，EIGRP拓扑表会存在两个下一跳，但是只会选择最优的添加进路由表。此时如果要保证路由表也有两条路径，必须手动修改V值(variance)，使得满足”最优路径的FD*V值&gt;次优路径的FD值”（默认情况下，v值为1）</p>
</blockquote>
<blockquote>
<p>此题中，最优路径为R2通过R1到达100.100.100.100，次优路径为经过R3、R1到达100.100.100.100</p>
</blockquote>
<blockquote>
<p>查看R2的路由表，此时显示的为最优路径，FD=409600</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/29/dTlmSs.png"></p>
<blockquote>
<p>次优路径的AD即为R3到达100.100.100.100的开销（FD），也为409600</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/29/dTl00K.png"></p>
<blockquote>
<p>此时不满足FC条件，则需更改开销，修改K值，更改R2的e0/0接口的延迟为3000（默认为1000），注意倍数关系</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/29/dTlfnP.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTgwut.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dTgRvn.png"></p>
<blockquote>
<p>将修改延迟的接口关闭再打开</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/29/dTgjDx.png"></p>
<blockquote>
<p>此时满足FC条件，即次优路径的AD值小于最优路径的FD值，在拓扑表中存在两条路径</p>
<p>此时的FS为R3</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/29/dT2nIS.png"></p>
<blockquote>
<p>但是此时路由表中到达100.100.100.100仍然只存在一条最优路径</p>
<p>若想让次优路径加表，则需满足：最优路径的FD*v值 &gt; 次优路径的FD才能加入到路由表</p>
<p>修改V值为6，此时满足条件，路由表中到达100.100.100.0网段存在两个下一跳</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/29/dT26Z6.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dT27eP.png"></p>
<blockquote>
<p>查看该路由的详细信息，可知基本满足1:5的关系</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/29/dTRdTf.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">相关命令</span><br><span class="line">R2(config)#int e0&#x2F;0</span><br><span class="line">R2(config-if)#delay n  --修改延迟，但是注意，如果输入的是n，那么延迟会改为10*n</span><br><span class="line">R2(config-if)#bandwidth n  --修改带宽，如果输入的是n，那么带宽就为n</span><br><span class="line"></span><br><span class="line">R2#show interfaces e0&#x2F;0  --看接口的详细信息，比如说带宽、延迟</span><br><span class="line">R2#show ip route 100.100.100.0 255.255.255.0  --查看该路由的详细信息</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>实验</category>
      </categories>
      <tags>
        <tag>路由协议</tag>
        <tag>CCNA</tag>
        <tag>EIGRP</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2020/08/26/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<a id="more"></a>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
      <categories>
        <category>Hello World</category>
      </categories>
      <tags>
        <tag>hello world</tag>
      </tags>
  </entry>
  <entry>
    <title>单区域OSPF的实现</title>
    <url>/2020/08/29/%E5%8D%95%E5%8C%BA%E5%9F%9FOSPF%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
    <content><![CDATA[<h4 id="1、实验目的"><a href="#1、实验目的" class="headerlink" title="1、实验目的"></a>1、实验目的</h4><p>1）掌握OSPF的基本配置<br>2）掌握OSPF的邻居表、拓扑表及路由表的含义<br>3）掌握OSPF的DR和BDR的作用<br>4）掌握OSPF的DR和BDR的选举<br>5）查看和调试OSPF路由协议的相关信息<br>6）熟悉OSPF中hello报文的作用和格式</p>
<a id="more"></a>
<h4 id="2、拓扑结构"><a href="#2、拓扑结构" class="headerlink" title="2、拓扑结构"></a>2、拓扑结构</h4><p><img src="https://s1.ax1x.com/2020/08/29/dHg68e.png" alt="拓扑图"></p>
<h4 id="3、实验步骤"><a href="#3、实验步骤" class="headerlink" title="3、实验步骤"></a>3、实验步骤</h4><p><strong>（1）完成各路由器的基本配置，实现各直连设备之间可以互ping对方，主机和路由器接口的地址自己规划</strong></p>
<ul>
<li>各接口地址如拓扑图标记所示进行配置</li>
</ul>
<p><strong>（2）全网启用OSPF，并划分如区域0</strong></p>
<blockquote>
<p>距离矢量为通告</p>
<p>链路状态为使能</p>
<p>network表示的是划分一个范围，路由器上属于此范围的对应接口加入OSPF的相应进程的相应区域</p>
<p>如network 192.168.12.0 0.0.0.255 area 0 表示的是划分一个范围为192.168.12.0，看此路由器上的哪个接口在这个范围内，则这个接口就会被加入OSPF的区域0中</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/29/dH2hQJ.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dH2Tdx.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dH2qJO.png"></p>
<p><strong>（3）观察各路由器的邻居表、拓扑表及路由表，观察哪些链路上有进行DR/BDR的选举，并测试主机之间的连通性</strong></p>
<blockquote>
<p>优先级用于选举DR/BDR——以太网链路存在DR/BDR的选举，串行链路则没有</p>
<p>选举规则：</p>
<ul>
<li><p>先比较优先级，优先级大的优先；默认情况下以太网接口的优先级都为1，串行链路的接口优先级都为0（优先级为0不能参与DR/BDR的选举）</p>
</li>
<li><p>如果优先级都一样，继续比较RID，RID大的优先</p>
</li>
<li><p>DR的选举是非抢占的</p>
</li>
</ul>
</blockquote>
<blockquote>
<p>Hello报文</p>
<p>作用：用来发现、建立、维持邻居之间的关系</p>
<p>每隔10s往224.0.0.5发送Hello报文，如果在40之后没有收到来自邻居的Hello，则认为该邻居挂了，就切断和该邻居之间的关系（死亡时间通常在30-39之间）</p>
</blockquote>
<blockquote>
<p>-————————————————————————————————————————–</p>
<p>Neighbor ID        Pri        State     Dead Time     Address                         Interface</p>
<p>  邻居的ID        优先级     状态          死亡时间      邻居的IP地址       自己用于建立邻居的接口</p>
<p>-————————————————————————————————————————–</p>
</blockquote>
<ul>
<li>邻居表</li>
</ul>
<p><img src="https://s1.ax1x.com/2020/08/29/dHWXqA.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dHWxat.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dHWzIP.png"></p>
<ul>
<li>拓扑表</li>
</ul>
<p><img src="https://s1.ax1x.com/2020/08/29/dHfVZn.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dHfeI0.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dHfuGT.png"></p>
<ul>
<li>路由表</li>
</ul>
<p><img src="https://s1.ax1x.com/2020/08/29/dHfydI.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dHfgFP.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dHffSS.png"></p>
<ul>
<li>连通性测试</li>
</ul>
<p><img src="https://s1.ax1x.com/2020/08/29/dHhpwR.png"></p>
<p><strong>（4）指定R2的RID为20.20.20.20，R3的RID为30.30.30.30，使用相关命令观察和验证各路由器RID的变化</strong></p>
<blockquote>
<p>【RID的选举】</p>
<ul>
<li><p>手工指定：最优先</p>
<p>R2(config)#router ospf 1</p>
<p>R2(config-router)#router-id 20.20.20.20    –手动指定RID</p>
<p>Reload or use “clear ip ospf process” command, for this to take effect</p>
<p>R2#clear ip ospf process    –重置OSPF的进程 </p>
<p>Reset ALL OSPF processes? [no]: y</p>
</li>
<li><p>自动选择：在没有手工指定情况下，优先选择回环口中IP地址最大的；若没有回环口，选择物理接口（双UP）中IP地址最大。</p>
</li>
</ul>
</blockquote>
<ul>
<li>查看当前R2和R3的RID，由于没有手工指定，也没有存在回环口，则选择物理接口中IP地址最大的作为RID</li>
</ul>
<p><img src="https://s1.ax1x.com/2020/08/29/dHhI1O.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dHhTje.png"></p>
<ul>
<li>指定R2和R3路由器的RID</li>
</ul>
<p><img src="https://s1.ax1x.com/2020/08/29/dH4PBj.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dH4kEn.png"></p>
<ul>
<li>再次查看R2和R3的RID</li>
</ul>
<p><img src="https://s1.ax1x.com/2020/08/29/dH4ANq.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dH4E40.png"></p>
<p><strong>（5）实现R2为以太网链路网段上的DR</strong></p>
<ul>
<li>由于R1和R2的优先级默认都为1，并且R2的RID为20.20.20.20，而R1的RID为192.168.12.1，此时需要修改R2的e0/0接口的优先级，使之成为以太网链路上的DR。此处指定R2上e0/0接口的优先级为2即可</li>
</ul>
<p><img src="https://s1.ax1x.com/2020/08/29/dH4zI1.png"></p>
<ul>
<li>由于DR、BDR的选举为非抢占，此时应重置OSPF进程</li>
</ul>
<p><img src="https://s1.ax1x.com/2020/08/29/dHIpwj.png"></p>
<ul>
<li>查看R1和R2的邻居表，可知此时R2成为以太网链路上的DR</li>
</ul>
<p><img src="https://s1.ax1x.com/2020/08/29/dHIFf0.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/29/dHIApV.png"></p>
<p><strong>（6）分别在R2和R3的路由器上添加172.16.2.0/24和172.16.3.0/24的网段，添加必要配置实现这两个网络之间的连通性</strong></p>
<ul>
<li>由于R3上已存在172.16.3.0/24网段，此时在R2上添加一个回环口（地址为172.16.2.2/24）用作测试</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">R2(config)#interface loopback 1</span><br><span class="line">R2(config-if)#ip address 172.16.2.2 255.255.255.0</span><br><span class="line">R2(config-if)#ip ospf 1 area 0  --把该接口加入到OSPF进程1区域0中</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2020/08/30/dHIqHJ.png"></p>
<p><img src="https://s1.ax1x.com/2020/08/30/dHIXNR.png"></p>
<p><strong>（7）开启debug信息，观察OSPF在以太网链路之间信息交互的过程</strong></p>
<p><img src="https://s1.ax1x.com/2020/08/30/dHIx9x.png"></p>
<p><strong>（8）开启debug信息，观察OSPF在串行链路之间信息交互的过程，比较以太网链路和串行链路上OSPF的debug信息输出的区别</strong></p>
<p><img src="https://s1.ax1x.com/2020/08/30/dHoPDe.png"></p>
<blockquote>
<p>最主要区别在于以太网链路会进行DR/BDR的选举；串行链路则没有进行DR/BDR的选举</p>
<p>以太网链路中，路由信息会先被发送到组播地址224.0.0.6，即被DR/BDR所接收，再由DR将此信息发送到组播地址224.0.0.5</p>
</blockquote>
<p><strong>（9）使用wireshark抓取OSPF的hello报文，理解hello报文各字段的含义</strong></p>
<blockquote>
<p>hello报文用于邻居的发现，建立和维持</p>
<p>hello报文中的相关信息包括：</p>
<ul>
<li>Network Mask：发送hello报文的接口所在网络的掩码</li>
<li>Hello Interval（默认为10s）：发送hello报文的时间间隔</li>
<li>Options：可选项<ul>
<li>E：允许Flood AS-External-LSAs</li>
<li>MC：转发IP组播报文</li>
<li>N/P：处理Type-7 LSAs</li>
<li>DC：处理按需链路</li>
</ul>
</li>
<li>Router Priority：优先级，默认为1，如果设置为0，则不参与DR或BDR的选举</li>
<li>Router Dead Interval（默认40s）：失效时间，如果在此时间内未收到邻居发送的hello报文，则认为邻居失效</li>
<li>Designated Router：DR的接口地址</li>
<li>Backup Designated Router：BDR的接口地址</li>
<li>Active Neighbor：活跃的邻居，以RID标识</li>
</ul>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/08/30/dHoE4I.png"></p>
]]></content>
      <categories>
        <category>实验</category>
      </categories>
      <tags>
        <tag>路由协议</tag>
        <tag>CCNA</tag>
        <tag>OSPF</tag>
      </tags>
  </entry>
</search>
